{
  "eventHandlers" : [
    {
      "class" : "org.forgerock.audit.handlers.csv.CsvAuditEventHandler",
      "config" : {
        "name" : "csv",
        "topics": [ "access", "activity", "config", "authentication" ],
        "logDirectory" : "/tmp/audit",
        "formatting" : {
          "quoteChar" : "\"",
          "delimiterChar" : ",",
          "endOfLineSymbols" : "\n"
        },
        "security" : {
          "enabled" : "false",
          "filename" : "/path/to/keystore.jks",
          "password" : "correcthorsebatterystaple",
          "signatureInterval" : "3 seconds"
        },
        "buffering" : {
          "enabled": "true",
          "autoFlush": "true"
        },
        "fileRotation" : {
          "rotationFileSuffix" : "-MM.dd.yy-kk.mm.ss",
          "rotationEnabled" : true,
          "rotationInterval" : "5 seconds",
          "maxFileSize" : 50,
          "rotationFilePrefix" : "prefix-"
        },
        "fileRetention" : {
          "maxNumberOfHistoryFiles": 0
        }
      }
    },
    {
      "class" : "org.forgerock.audit.handlers.syslog.SyslogAuditEventHandler",
      "config" : {
        "name" : "syslog",
        "topics": [ "access", "activity", "config", "authentication" ],
        "protocol" : "UDP",
        "host" : "localhost",
        "port" : 514,
        "facility" : "LOCAL0",
        "severityFieldMappings": [{
          "topic" : "system-status",
          "field"  : "level",
          "valueMappings" : {
            "SEVERE" : "EMERGENCY",
            "WARNING" : "WARNING",
            "INFO" : "INFORMATIONAL"
          }
        }],
        "buffering" : {
          "enabled" : "true"
        }
      }
    },
    {
      "class" : "org.forgerock.audit.handlers.jdbc.JdbcAuditEventHandler",
      "config" : {
        "name" : "jdbc",
        "topics": [ "access", "activity", "config", "authentication" ],
        "databaseType" : "mysql",
        "connectionPool" : {
          "jdbcUrl" : "jdbc:mysql://localhost:3306/audit?allowMultiQueries=true&characterEncoding=utf8",
          "username" : "auditAdmin",
          "password" : "auditAdminPassword"
        },
        "tableMappings" : [
          {
            "event": "authentication",
            "table": "auditauthentication",
            "fieldToColumn": {
              "_id" : "id",
              "transactionId" : "transactionid",
              "timestamp" : "timestamp_",
              "authentication/id" : "authentication_id",
              "eventName" : "eventname",
              "result" : "result",
              "principal" : "principals",
              "context" : "context",
              "sessionId" : "sessionid",
              "entries" : "entries"
            }
          },
          {
            "event": "activity",
            "table": "auditactivity",
            "fieldToColumn": {
              "_id" : "id",
              "timestamp" : "timestamp_",
              "transactionId" : "transactionid",
              "eventName" : "eventname",
              "authentication/id" : "authentication_id",
              "runAs" : "runas",
              "resourceOperation/uri" : "resource_uri",
              "resourceOperation/protocol" : "resource_protocol",
              "resourceOperation/operation/method" : "resource_method",
              "resourceOperation/operation/detail" : "resource_detail",
              "before" : "before",
              "after" : "after",
              "changedFields" : "changedfields",
              "revision" : "rev"
            }
          },
          {
            "event": "access",
            "table": "auditaccess",
            "fieldToColumn": {
              "_id" : "id",
              "timestamp" : "timestamp_",
              "transactionId" : "transactionid",
              "eventName" : "eventname",
              "server/ip" : "server_ip",
              "server/port" : "server_port",
              "client/host" : "client_host",
              "client/ip" : "client_ip",
              "client/port" : "client_port",
              "authentication/id" : "authentication_id",
              "authorizationId/id" : "authorizationid_id",
              "authorizationId/roles" : "authorizationid_roles",
              "authorizationId/component" : "authorizationid_component",
              "resourceOperation/uri" : "resource_uri",
              "resourceOperation/protocol" : "resource_protocol",
              "resourceOperation/operation/method" : "resource_method",
              "resourceOperation/operation/detail" : "resource_detail",
              "http/method" : "http_method",
              "http/path" : "http_path",
              "http/queryString" : "http_querystring",
              "http/headers" : "http_headers",
              "response/status" : "status",
              "response/elapsedTime" : "elapsedtime"
            }
          },
          {
            "event": "config",
            "table": "auditconfig",
            "fieldToColumn": {
              "_id" : "id",
              "timestamp" : "timestamp_",
              "transactionId" : "transactionid",
              "eventName" : "eventname",
              "authentication/id" : "authentication_id",
              "runAs" : "runas",
              "resourceOperation/uri" : "resource_uri",
              "resourceOperation/protocol" : "resource_protocol",
              "resourceOperation/operation/method" : "resource_method",
              "resourceOperation/operation/detail" : "resource_detail",
              "before" : "before",
              "after" : "after",
              "changedFields" : "changedfields",
              "revision" : "rev"
            }
          }
        ]
      }
    }
  ]
}
