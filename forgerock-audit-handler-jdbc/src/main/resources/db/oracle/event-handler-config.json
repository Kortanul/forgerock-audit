{
  "name" : "jdbc",
  "class" : "org.forgerock.audit.handlers.jdbc.JDBCAuditEventHandler",
  "config" : {
    "databaseName" : "oracle",
    "connectionPool" : {
      "jdbcUrl": "jdbc:oracle:thin:@//localhost:1521/XE",
      "username": "audit",
      "password": "audit"
    },
    "tableMappings" : [
      {
        "event": "authentication",
        "table": "auditauthentication",
        "fieldToColumn": {
          "_id" : "id",
          "transactionId" : "transactionid",
          "timestamp" : "timestamp",
          "authentication/id" : "authentication_id",
          "eventName" : "eventname",
          "result" : "result",
          "principal" : "principals",
          "context" : "context",
          "sessionId" : "sessionid",
          "entries" : "entries"
        }
      },
      {
        "event": "activity",
        "table": "auditactivity",
        "fieldToColumn": {
          "_id" : "id",
          "timestamp" : "timestamp",
          "transactionId" : "transactionid",
          "eventName" : "eventname",
          "authentication/id" : "authentication_id",
          "runAs" : "runas",
          "resourceOperation/uri" : "resource_uri",
          "resourceOperation/protocol" : "resource_protocol",
          "resourceOperation/operation/method" : "resource_method",
          "resourceOperation/operation/detail" : "resource_detail",
          "before" : "before",
          "after" : "after",
          "changedFields" : "changedfields",
          "revision" : "rev"
        }
      },
      {
        "event": "access",
        "table": "auditaccess",
        "fieldToColumn": {
          "_id" : "objectid",
          "timestamp" : "timestamp",
          "transactionId" : "transactionid",
          "eventName" : "eventname",
          "server/ip" : "server_ip",
          "server/port" : "server_port",
          "client/host" : "client_host",
          "client/ip" : "client_ip",
          "client/port" : "client_port",
          "authentication/id" : "authentication_id",
          "authorizationId/id" : "authorizationid_id",
          "authorizationId/roles" : "authorizationid_roles",
          "authorizationId/component" : "authorizationid_component",
          "resourceOperation/uri" : "resource_uri",
          "resourceOperation/protocol" : "resource_protocol",
          "resourceOperation/operation/method" : "resource_method",
          "resourceOperation/operation/detail" : "resource_detail",
          "http/method" : "http_method",
          "http/path" : "http_path",
          "http/queryString" : "http_querystring",
          "http/headers" : "http_headers",
          "response/status" : "status",
          "response/elapsedTime" : "elapsedtime"
        }
      },
      {
        "event": "config",
        "table": "auditconfig",
        "fieldToColumn": {
          "_id" : "id",
          "timestamp" : "timestamp",
          "transactionId" : "transactionid",
          "eventName" : "eventname",
          "authentication/id" : "authentication_id",
          "runAs" : "runas",
          "resourceOperation/uri" : "resource_uri",
          "resourceOperation/protocol" : "resource_protocol",
          "resourceOperation/operation/method" : "resource_method",
          "resourceOperation/operation/detail" : "resource_detail",
          "before" : "before",
          "after" : "after",
          "changedFields" : "changedfields",
          "revision" : "rev"
        }
      }
    ]
  },
  "events" : [ "access", "activity", "config", "authentication" ]
}